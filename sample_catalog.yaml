benchmarks:
  display_name: Benchmarks
  description: Benchmark indices, constituents, and returns
  ownership:
    accountable_owner: indices-governance@firm.com
    data_specialist: quant-research@firm.com
    support_channel: '#benchmarks'
  documentation:
    glossary: https://confluence.firm.com/display/DATA/Benchmark+Glossary
    runbook: https://confluence.firm.com/display/OPS/Benchmark+Runbook
    data_dictionary: https://confluence.firm.com/display/DATA/Benchmark+Data+Dictionary
benchmarks.constituents:
  display_name: Benchmark Constituents
  description: Index membership and weights
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: ANALYTICS_WH
      database: BENCHMARKS
      schema: CONSTITUENTS
      query: "SELECT benchmark_id, security_id, weight, sector, country\nFROM BENCHMARK_CONSTITUENTS\n\
        WHERE benchmark_id = '{segments[0]}'\n  AND as_of_date = TO_DATE('{segments[1]}',\
        \ 'YYYYMMDD')\n"

# Example of a cached query - expensive Snowflake query that runs in background
benchmarks.constituents_all:
  display_name: All Benchmark Constituents (Cached)
  description: |
    Complete benchmark constituents with all indices - this is a slow 10-minute query
    that is cached in Redis and refreshed in the background every 10 minutes.
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: ANALYTICS_WH
      database: BENCHMARKS
      schema: CONSTITUENTS
      query: |
        SELECT benchmark_id, security_id, weight, sector, country, as_of_date
        FROM BENCHMARK_CONSTITUENTS
        WHERE as_of_date = (SELECT MAX(as_of_date) FROM BENCHMARK_CONSTITUENTS)
    cache:
      enabled: true
      ttl_seconds: 3600           # Serve from cache for 1 hour
      refresh_interval_seconds: 600  # Background refresh every 10 min
      refresh_on_startup: true    # Pre-warm cache on service start
benchmarks.corporate:
  display_name: Corporate Bond Indices
  description: Investment grade and high yield corporate bond indices
  ownership:
    data_specialist: credit-research@firm.com
benchmarks.corporate/ig:
  display_name: Investment Grade Corporate
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: ANALYTICS_WH
      database: BENCHMARKS
      schema: CORPORATE
      query: 'SELECT index_id, sector, rating_bucket, spread, oas, duration

        FROM IG_CORPORATE_INDICES

        WHERE sector = ''{segments[0]}''

        '
benchmarks.returns:
  display_name: Benchmark Returns
  description: Daily, MTD, YTD returns for benchmarks
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: ANALYTICS_WH
      database: BENCHMARKS
      schema: RETURNS
      query: 'SELECT benchmark_id, as_of_date, return_1d, return_mtd, return_ytd

        FROM BENCHMARK_RETURNS

        WHERE benchmark_id = ''{segments[0]}''

        '
benchmarks.sovereign:
  display_name: Sovereign Bond Indices
  description: Government bond indices by region and currency
benchmarks.sovereign/developed:
  display_name: Developed Markets Sovereign
  description: DM government bond benchmarks
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: ANALYTICS_WH
      database: BENCHMARKS
      schema: SOVEREIGN
      query: "SELECT index_id, index_name, currency, weight, yield, duration, mod_duration\n\
        FROM DM_SOVEREIGN_INDICES\nWHERE {filter[0]:index_family}\n  AND {filter[1]:currency}\n\
        \  AND as_of_date = {version_date}\n"
commodities:
  display_name: Commodities
  description: Commodity futures, spot prices, and derivatives
  ownership:
    accountable_owner: commodities-desk@firm.com
    data_specialist: commodities-quant@firm.com
    support_channel: '#commodities-data'
  documentation:
    glossary: https://confluence.firm.com/display/DATA/Commodities+Glossary
    data_dictionary: https://confluence.firm.com/display/DATA/Commodities+Data+Dictionary
commodities.crypto:
  display_name: Digital Assets
  description: Cryptocurrency spot and derivatives
  ownership:
    data_specialist: digital-assets@firm.com
  source_binding:
    type: rest
    config:
      base_url: https://crypto-data.internal.firm.com
      path_template: /api/v3/assets/{segments[0]}
      method: GET
      auth_type: api_key
commodities.energy:
  display_name: Energy Commodities
  description: Crude oil, natural gas, and refined products
  source_binding:
    type: rest
    config:
      base_url: https://api.nefa.energy
      path_template: /v2/commodities/energy/{segments[0]}/{segments[1]}
      method: GET
      auth_type: api_key
      headers:
        Accept: application/json
        X-API-Version: '2.0'
  schema:
    columns:
    - name: SYMBOL
      type: string
      description: Commodity symbol (CL=Crude, NG=NatGas)
      semantic_type: identifier
    - name: CONTRACT
      type: string
      description: Contract type (SPOT, F1, F2)
      semantic_type: dimension
    - name: PRICE
      type: float
      description: Price per unit (USD)
      semantic_type: measure
    - name: VOLUME
      type: integer
      description: Trading volume (contracts)
      semantic_type: measure
    semantic_tags:
    - commodities
    - energy
    - crude-oil
    - natural-gas
    - futures
commodities.metals:
  display_name: Precious & Industrial Metals
  description: Gold, silver, copper, and other metals
  source_binding:
    type: rest
    config:
      base_url: https://api.nefa.energy
      path_template: /v2/commodities/metals/{segments[0]}/{segments[1]}
      method: GET
      auth_type: api_key
fixed_income:
  display_name: Fixed Income
  description: Government bonds, corporates, and structured products
  ownership:
    accountable_owner: fixed-income-governance@firm.com
    data_specialist: fi-desk@firm.com
    support_channel: '#fixed-income'
    adop: fi-trading-head@firm.com
    ads: fi-data-steward@firm.com
  documentation:
    glossary: https://confluence.firm.com/display/FI/Fixed+Income+Glossary
    data_dictionary: https://confluence.firm.com/display/FI/Bond+Data+Dictionary
fixed_income.govies:
  display_name: Government Bonds
  description: Sovereign debt securities and yields
fixed_income.govies/sovereign:
  display_name: International Sovereign Bonds
  description: Non-US government bonds (Bunds, Gilts, JGBs, etc.)
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: MARKET_DATA_WH
      database: FIXED_INCOME
      schema: GOVIES
      query: "SELECT asof_date, isin, country, tenor, yield, spread_vs_usd, price,\
        \ duration\nFROM SOVEREIGN_BONDS\nWHERE ('{segments[0]}' = 'ALL' OR country\
        \ = '{segments[0]}')\n  AND ('{segments[1]}' = 'ALL' OR tenor = '{segments[1]}')\n\
        ORDER BY asof_date DESC, country, tenor\n"
fixed_income.govies/treasury:
  display_name: US Treasury Securities
  description: US Treasury bills, notes, and bonds with yields and pricing
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: MARKET_DATA_WH
      database: FIXED_INCOME
      schema: GOVIES
      query: "SELECT asof_date, cusip, tenor, coupon, yield, price, duration, convexity\n\
        FROM TREASURY_SECURITIES\nWHERE ('{segments[0]}' = 'ALL' OR tenor = '{segments[0]}')\n\
        \  AND ('{segments[1]}' = 'ALL' OR cusip = '{segments[1]}')\nORDER BY asof_date\
        \ DESC, tenor\n"
  schema:
    columns:
    - name: ASOF_DATE
      type: date
      description: Pricing date
      semantic_type: timestamp
      primary_key: true
    - name: CUSIP
      type: string
      description: CUSIP identifier
      semantic_type: identifier
      primary_key: true
    - name: TENOR
      type: string
      description: Maturity tenor (3M, 6M, 1Y, 2Y, 5Y, 10Y, 30Y)
      semantic_type: dimension
    - name: YIELD
      type: float
      description: Yield to maturity (decimal)
      semantic_type: measure
    - name: DURATION
      type: float
      description: Modified duration (years)
      semantic_type: measure
    semantic_tags:
    - treasury
    - fixed-income
    - yield-curve
    - risk-free-rate
    use_cases:
    - Build yield curve for discounting
    - Calculate duration and convexity
    - Benchmark against risk-free rate
fixed_income.mbs:
  display_name: Mortgage-Backed Securities
  description: Agency MBS pool data and prepayment analytics
  ownership:
    data_specialist: mbs-research@firm.com
    support_channel: '#mortgage-data'
  classification: confidential
fixed_income.mbs/pools:
  display_name: MBS Pool Data
  description: Agency MBS pool characteristics and analytics
  source_binding:
    type: excel
    config:
      base_path: /data/mbs/pools
      file_pattern: '{segments[0]}_{segments[1]}_pools.xlsx'
      sheet: PoolData
      header_row: 2
  schema:
    columns:
    - name: POOL_ID
      type: string
      description: Pool identifier (CUSIP)
      semantic_type: identifier
    - name: AGENCY
      type: string
      description: Issuing agency (FNMA, FHLMC, GNMA)
      semantic_type: dimension
    - name: WAC
      type: float
      description: Weighted average coupon
      semantic_type: measure
    - name: WAM
      type: integer
      description: Weighted average maturity (months)
      semantic_type: measure
    - name: CPR_1M
      type: float
      description: 1-month conditional prepayment rate
      semantic_type: measure
    - name: OAS
      type: float
      description: Option-adjusted spread (bps)
      semantic_type: measure
    semantic_tags:
    - mortgages
    - mbs
    - agency
    - prepayment
    - fixed-income
fixed_income.mbs/prepay:
  display_name: Prepayment Projections
  description: MBS prepayment model outputs
  source_binding:
    type: excel
    config:
      base_path: /data/mbs/prepay
      file_pattern: '{segments[0]}_{segments[1]}_prepay.xlsx'
      sheet: Projections
      header_row: 1
flows:
  display_name: Fund Flows
  description: Subscriptions, redemptions, and AUM
  ownership:
    accountable_owner: transfer-agency@firm.com
    data_specialist: flows-ops@firm.com
    support_channel: '#fund-flows'
  classification: confidential
flows.aum:
  display_name: Assets Under Management
  description: Daily AUM by fund and strategy
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: TA_WH
      database: FLOWS
      schema: AUM
      query: 'SELECT fund_id, as_of_date, aum, aum_change_1d, net_flows_mtd

        FROM DAILY_AUM

        WHERE (''{segments[0]}'' = ''ALL'' OR fund_id = ''{segments[0]}'')

        '
flows.redemptions:
  display_name: Redemptions
  description: Money out of funds
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: TA_WH
      database: FLOWS
      schema: TRANSACTIONS
      query: 'SELECT fund_id, trade_date, settle_date, amount, shares, investor_type

        FROM REDEMPTIONS

        WHERE fund_id = ''{segments[0]}''

        '
flows.subscriptions:
  display_name: Subscriptions
  description: New money into funds
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: TA_WH
      database: FLOWS
      schema: TRANSACTIONS
      query: 'SELECT fund_id, trade_date, settle_date, amount, shares, investor_type

        FROM SUBSCRIPTIONS

        WHERE fund_id = ''{segments[0]}''

        '
nav:
  display_name: NAV
  description: Net Asset Value and fund accounting
  ownership:
    accountable_owner: fund-accounting@firm.com
    data_specialist: nav-ops@firm.com
    support_channel: '#nav-support'
  classification: confidential
nav.estimated:
  display_name: Estimated NAV
  description: Intraday estimated NAV
  source_binding:
    type: rest
    config:
      base_url: https://nav-service.internal.firm.com
      path_template: /api/v1/estimated/{segments[0]}
      method: GET
      auth_type: bearer
nav.official:
  display_name: Official NAV
  description: End of day official NAV per share
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: ACCOUNTING_WH
      database: NAV
      schema: OFFICIAL
      query: "SELECT fund_id, as_of_date, nav_per_share, total_nav, shares_outstanding\n\
        FROM OFFICIAL_NAV\nWHERE fund_id = '{segments[0]}'\n  AND ('{segments[1]}'\
        \ = 'ALL' OR as_of_date = TO_DATE('{segments[1]}', 'YYYYMMDD'))\n"
portfolios:
  display_name: Portfolios
  description: Portfolio master, holdings, performance, and attribution
  ownership:
    accountable_owner: portfolio-ops@firm.com
    data_specialist: portfolio-management@firm.com
    support_channel: '#portfolios'
  documentation:
    glossary: https://confluence.firm.com/display/PM/Portfolio+Glossary
    runbook: https://confluence.firm.com/display/OPS/Portfolio+System+Runbook
    onboarding: https://confluence.firm.com/display/PM/Portfolio+Data+Onboarding
    data_dictionary: https://confluence.firm.com/display/PM/Portfolio+Data+Dictionary
  classification: confidential
portfolios.attribution:
  display_name: Performance Attribution
  description: Return attribution by factor, sector, security
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: ANALYTICS_WH
      database: PORTFOLIOS
      schema: ATTRIBUTION
      query: "SELECT portfolio_id, as_of_date, dimension, bucket,\n       allocation_effect,\
        \ selection_effect, interaction_effect, total_effect\nFROM RETURN_ATTRIBUTION\n\
        WHERE portfolio_id = '{segments[0]}'\n  AND as_of_date = TO_DATE('{segments[1]}',\
        \ 'YYYYMMDD')\n"
portfolios.exposures:
  display_name: Exposure Analysis
  description: Portfolio exposure breakdown by dimension
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: ANALYTICS_WH
      database: PORTFOLIOS
      schema: ANALYTICS
      query: "SELECT portfolio_id, dimension, bucket, exposure_pct, notional\nFROM\
        \ EXPOSURE_BREAKDOWN\nWHERE as_of_date = TO_DATE('{segments[1]}', 'YYYYMMDD')\n\
        \  AND portfolio_id = '{segments[0]}'\n"
portfolios.holdings:
  display_name: Portfolio Holdings
  description: End of day positions by portfolio and date
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: POSITIONS_WH
      database: PORTFOLIOS
      schema: HOLDINGS
      query: "SELECT portfolio_id, security_id, quantity, market_value,\n       cost_basis,\
        \ unrealized_pnl, currency\nFROM DAILY_POSITIONS\nWHERE as_of_date = TO_DATE('{segments[1]}',\
        \ 'YYYYMMDD')\n  AND portfolio_id = '{segments[0]}'\n"
portfolios.performance:
  display_name: Portfolio Performance
  description: Returns, TWR, attribution by portfolio
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: ANALYTICS_WH
      database: PORTFOLIOS
      schema: PERFORMANCE
      query: "SELECT portfolio_id, as_of_date, twr_1d, twr_mtd, twr_ytd,\n       benchmark_id,\
        \ excess_return, tracking_error\nFROM PORTFOLIO_PERFORMANCE\nWHERE portfolio_id\
        \ = '{segments[0]}'\n  AND ('{segments[1]}' = 'ALL' OR as_of_date >= TO_DATE('{segments[1]}',\
        \ 'YYYYMMDD'))\n"
prices:
  display_name: Prices
  description: Real-time and historical security prices
  ownership:
    accountable_owner: market-data-governance@firm.com
    data_specialist: market-data-ops@firm.com
    support_channel: '#market-data'
  documentation:
    glossary: https://confluence.firm.com/display/MKTDATA/Pricing+Glossary
    runbook: https://confluence.firm.com/display/OPS/Market+Data+Runbook
    onboarding: https://confluence.firm.com/display/MKTDATA/Market+Data+Onboarding
    data_dictionary: https://confluence.firm.com/display/MKTDATA/Price+Fields+Dictionary
prices.equity:
  display_name: Equity Prices
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: MARKET_DATA_WH
      database: PRICES
      schema: EQUITY
      query: "SELECT symbol, open_price, high_price, low_price, close_price, volume,\
        \ vwap\nFROM EQUITY_EOD\nWHERE {filter[0]:symbol}\n  AND trade_date = CASE\n\
        \    WHEN {is_latest} = 'true' THEN (SELECT MAX(trade_date) FROM EQUITY_EOD)\n\
        \    ELSE {version_date}\n  END\n"
prices.fixed_income:
  display_name: Fixed Income Prices
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: MARKET_DATA_WH
      database: PRICES
      schema: FIXED_INCOME
      query: 'SELECT security_id, bid_price, ask_price, mid_price, yield_to_maturity,
        spread

        FROM BOND_PRICES

        WHERE security_id = ''{segments[0]}''

        '
prices.fx:
  display_name: FX Rates
  source_binding:
    type: rest
    config:
      base_url: https://fx-service.internal.firm.com
      path_template: /api/v1/rates/{segments[0]}/{segments[1]}
      method: GET
      auth_type: bearer
rates:
  display_name: Interest Rates
  description: Interest rate curves, swaps, and money market rates
  ownership:
    accountable_owner: rates-governance@firm.com
    data_specialist: rates-quant@firm.com
    support_channel: '#rates-data'
    adop: rates-trading-head@firm.com
    ads: rates-data-steward@firm.com
    adal: rates-access-control@firm.com
  documentation:
    glossary: https://confluence.firm.com/display/RATES/Interest+Rates+Glossary
    runbook: https://confluence.firm.com/display/OPS/Rates+Data+Runbook
    data_dictionary: https://confluence.firm.com/display/RATES/Swap+Rates+Dictionary
    additional:
      sofr_transition: https://confluence.firm.com/display/RATES/SOFR+Transition+Guide
      curve_construction: https://confluence.firm.com/display/QUANT/Yield+Curve+Methodology
rates.curves:
  display_name: Yield Curves
  description: Constructed yield curves by currency
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: MARKET_DATA_WH
      database: RATES
      schema: CURVES
      query: "SELECT asof_date, currency, tenor, zero_rate, discount_factor\nFROM\
        \ YIELD_CURVES\nWHERE currency = '{segments[0]}'\n  AND asof_date = TO_DATE('{segments[1]}',\
        \ 'YYYYMMDD')\n"
rates.sofr:
  display_name: SOFR Rates
  description: Secured Overnight Financing Rate and term SOFR
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: MARKET_DATA_WH
      database: RATES
      schema: BENCHMARKS
      query: 'SELECT asof_date, ''USD'' as currency, rate_type, rate

        FROM SOFR_RATES

        WHERE (''{segments[0]}'' = ''ALL'' OR rate_type = ''{segments[0]}'')

        ORDER BY asof_date DESC

        '
  schema:
    columns:
    - name: ASOF_DATE
      type: date
      description: Rate date
      semantic_type: timestamp
    - name: RATE_TYPE
      type: string
      description: SOFR type (ON, 30D_AVG, 90D_AVG, TERM_1M, TERM_3M)
      semantic_type: dimension
    - name: RATE
      type: float
      description: Rate value (decimal)
      semantic_type: measure
    semantic_tags:
    - sofr
    - risk-free-rate
    - overnight
    - benchmark
    - interest-rates
rates.swap:
  display_name: Interest Rate Swaps
  description: Par swap rates across currencies and tenors
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: MARKET_DATA_WH
      database: RATES
      schema: SWAPS
      segment_names: currency,tenor,date
      query: |
        SELECT asof_date, currency, tenor, par_rate, spread_vs_govt, dv01
        FROM SWAP_RATES
        WHERE ('{segments[0]}' = 'ALL' OR currency = '{segments[0]}')
          AND ('{segments[1]}' = 'ALL' OR tenor = '{segments[1]}')
          AND ('{segments[2]}' = 'ALL' OR asof_date = TO_DATE('{segments[2]}', 'YYYYMMDD'))
        ORDER BY asof_date DESC, currency, tenor
reference:
  display_name: Reference Data
  description: Calendars, classifications, and static reference
  ownership:
    accountable_owner: ref-data-governance@firm.com
    data_specialist: ref-data-ops@firm.com
    support_channel: '#reference-data'
  documentation:
    glossary: https://confluence.firm.com/display/DATA/Reference+Data+Glossary
    data_dictionary: https://confluence.firm.com/display/DATA/Reference+Data+Dictionary
reference.calendars:
  display_name: Trading Calendars
  description: Exchange and settlement calendars
reference.calendars/exchange:
  display_name: Exchange Calendars
  source_binding:
    type: static
    config:
      base_path: /data/reference/calendars/exchange
      file_pattern: '{segments[0]}.json'
      format: json
reference.calendars/settlement:
  display_name: Settlement Calendars
  source_binding:
    type: static
    config:
      base_path: /data/reference/calendars/settlement
      file_pattern: '{segments[0]}.csv'
      format: csv
reference.classifications:
  display_name: Classifications
  description: Industry, sector, and other classification schemes
reference.classifications/gics:
  display_name: GICS Codes
  description: Global Industry Classification Standard
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: REF_DATA_WH
      database: REFERENCE
      schema: CLASSIFICATIONS
      query: 'SELECT gics_code, sector, industry_group, industry, sub_industry

        FROM GICS_HIERARCHY

        WHERE (''{segments[0]}'' = ''ALL'' OR gics_code LIKE ''{segments[0]}%'')

        '
reports:
  display_name: Reports
  description: Generated reports and regulatory filings
  ownership:
    accountable_owner: reporting-ops@firm.com
    data_specialist: report-dev@firm.com
    support_channel: '#reporting'
reports.client:
  display_name: Client Reports
  description: Client-facing reports and statements
  source_binding:
    type: static
    config:
      base_path: /data/reports/client
      file_pattern: '{segments[0]}/{segments[1]}.pdf'
      format: binary
  classification: confidential
reports.daily:
  display_name: Daily Reports
  source_binding:
    type: static
    config:
      base_path: /data/reports/daily
      file_pattern: '{segments[0]}/{segments[1]}.pdf'
      format: binary
reports.regulatory:
  display_name: Regulatory Reports
  source_binding:
    type: excel
    config:
      base_path: /data/reports/regulatory
      file_pattern: '{segments[0]}/{segments[1]}.xlsx'
      sheet: Summary
  classification: restricted
risk:
  display_name: Risk
  description: VaR, CVaR, stress testing, and risk measures
  ownership:
    accountable_owner: risk-governance@firm.com
    data_specialist: risk-quant@firm.com
    support_channel: '#risk-analytics'
  documentation:
    glossary: https://confluence.firm.com/display/RISK/Risk+Measures+Glossary
    runbook: https://confluence.firm.com/display/OPS/Proteus+Risk+Engine+Runbook
    data_dictionary: https://confluence.firm.com/display/RISK/Risk+Data+Dictionary
    additional:
      regulatory_guide: https://confluence.firm.com/display/RISK/BCBS239+Compliance+Guide
      methodology: https://confluence.firm.com/display/QUANT/Risk+Methodology
  classification: confidential
risk.cvar:
  display_name: Conditional Value at Risk
  description: CVaR tail risk measures by portfolio, currency, and security
  ownership:
    adop: quant-research@firm.com
    ads: risk-data-steward@firm.com
    adal: risk-access-control@firm.com
  source_binding:
    type: oracle
    config:
      dsn: proteus.firm.com:1521/RISKDB
      query: "SELECT asof_date, port_no, port_type, ssm_id, base_currency,\n     \
        \  acct_key, lt_id, cvar_coeff, cvar\nFROM proteus_2_own.te_stress_tail_risk_pnl\n\
        WHERE ('{segments[0]}' = 'ALL' OR port_no || '-' || port_type = '{segments[0]}')\n\
        \  AND ('{segments[1]}' = 'ALL' OR base_currency = '{segments[1]}')\n  AND\
        \ ('{segments[2]}' = 'ALL' OR ssm_id = '{segments[2]}')\nORDER BY asof_date\
        \ DESC, port_no, ssm_id\n"
  schema:
    columns:
    - name: ASOF_DATE
      type: date
      description: Business date (T+1)
      semantic_type: timestamp
      primary_key: true
    - name: PORT_NO
      type: string
      description: Portfolio number
      semantic_type: identifier
      primary_key: true
    - name: SSM_ID
      type: string
      description: Security master ID
      semantic_type: identifier
      foreign_key: securities/lookup
    - name: CVAR
      type: float
      description: Conditional Value at Risk
      semantic_type: measure
    semantic_tags:
    - risk
    - cvar
    - tail-risk
    - portfolio-analytics
    - regulatory
  access_policy:
    min_filters: 1
    blocked_patterns:
    - ALL/ALL/ALL
    max_rows_warn: 10000000
    denial_message: 'Query blocked: CVaR table is very large.

      You must specify at least one filter (portfolio, currency, or security).

      Example: risk.cvar/758-A/USD/ALL

      '
risk.greeks:
  display_name: Greeks
  description: Delta, gamma, vega, theta by portfolio
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: RISK_WH
      database: RISK
      schema: GREEKS
      query: "SELECT portfolio_id, security_id, delta, gamma, vega, theta, rho\nFROM\
        \ POSITION_GREEKS\nWHERE portfolio_id = '{segments[0]}'\n  AND as_of_date\
        \ = TO_DATE('{segments[1]}', 'YYYYMMDD')\n"
risk.limits:
  display_name: Risk Limits
  description: Limit utilization and breaches
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: RISK_WH
      database: RISK
      schema: LIMITS
      query: 'SELECT portfolio_id, limit_type, limit_value, current_value, utilization_pct

        FROM LIMIT_UTILIZATION

        WHERE portfolio_id = ''{segments[0]}''

        '
risk.stress:
  display_name: Stress Testing
  description: Scenario analysis and stress test results
  source_binding:
    type: rest
    config:
      base_url: https://risk-engine.internal.firm.com
      path_template: /api/v2/stress/{segments[0]}/{segments[1]}
      method: GET
      auth_type: bearer
risk.var:
  display_name: Value at Risk
  description: Daily VaR by portfolio
  source_binding:
    type: rest
    config:
      base_url: https://risk-engine.internal.firm.com
      path_template: /api/v2/var/{segments[0]}/{segments[1]}
      method: GET
      auth_type: bearer
securities:
  display_name: Securities
  description: Security master lookup by any identifier
  ownership:
    accountable_owner: ref-data-governance@firm.com
    data_specialist: security-ops@firm.com
    support_channel: '#securities'
  documentation:
    glossary: https://confluence.firm.com/display/DATA/Security+Glossary
    data_dictionary: https://confluence.firm.com/display/DATA/Security+Master+Dictionary
securities/lookup:
  display_name: Security Lookup
  description: Lookup security by ISIN, CUSIP, SEDOL, or ticker
  source_binding:
    type: oracle
    config:
      dsn: secmaster.firm.com:1521/SECMASTER
      query: "SELECT isin, cusip, sedol, ticker, issuer_name,\n       country_code,\
        \ currency, security_type, active_flag\nFROM SECURITY_MASTER\nWHERE isin =\
        \ '{segments[0]}'\n   OR cusip = '{segments[0]}'\n   OR sedol = '{segments[0]}'\n\
        \   OR ticker = '{segments[0]}'\n"
securities/terms:
  display_name: Security Terms
  description: Detailed security attributes and terms
  source_binding:
    type: opensearch
    config:
      hosts:
      - https://search.internal.firm.com:9200
      index: instruments-v2
      query: "{\n  \"query\": {\n    \"bool\": {\n      \"must\": [\n        {\"term\"\
        : {\"security_id\": \"{segments[0]}\"}}\n      ]\n    }\n  }\n}\n"

# ==========================================================================
# FLOWS - Fund flows and AUM data
# ==========================================================================
flows.redemptions:
  display_name: Fund Redemptions
  description: Daily redemption transactions by fund
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: TA_WH
      database: FLOWS
      schema: TRANSACTIONS
      query: |
        SELECT fund_id, trade_date, settle_date, amount, shares, investor_type
        FROM REDEMPTIONS
        WHERE fund_id = '{segments[0]}'

flows.aum:
  display_name: Assets Under Management
  description: Daily AUM by fund and strategy
  source_binding:
    type: snowflake
    config:
      account: firm-prod.us-east-1
      warehouse: TA_WH
      database: FLOWS
      schema: AUM
      query: |
        SELECT fund_id, as_of_date, aum, aum_change_1d, net_flows_mtd
        FROM DAILY_AUM
        WHERE ('{segments[0]}' = 'ALL' OR fund_id = '{segments[0]}')

# ==========================================================================
# CREDIT - Credit Risk (MS-SQL) - from demo catalog
# ==========================================================================
credit:
  display_name: Credit Risk
  description: Counterparty credit exposures, limits, and risk metrics from the Credit Risk Engine (SQL Server)
  ownership:
    accountable_owner: credit-risk-governance@firm.com
    data_specialist: credit-analytics@firm.com
    support_channel: "#credit-risk-data"

credit.exposures:
  display_name: Credit Exposures
  description: Daily counterparty credit exposure snapshots including notional, MTM, PFE, CVA, and expected loss by exposure type
  source_binding:
    type: mssql
    config:
      server: credit-risk-sql.firm.com
      port: 1433
      database: CreditRisk
      driver: "ODBC Driver 17 for SQL Server"
      query: >
        SELECT ASOF_DATE, COUNTERPARTY_ID, COUNTERPARTY_NAME,
        SECTOR, RATING, COUNTRY, EXPOSURE_TYPE, NOTIONAL,
        MARK_TO_MARKET, PFE, CVA, LGD, PD, EXPECTED_LOSS, CURRENCY
        FROM [dbo].[credit_exposures]
        WHERE ASOF_DATE >= DATEADD(DAY, -30, GETDATE())
  schema:
    description: Daily counterparty credit exposure snapshots with full risk metrics
    semantic_tags: [credit, risk, counterparty, exposure, timeseries]
    primary_key: [ASOF_DATE, COUNTERPARTY_ID, EXPOSURE_TYPE]
    granularity: daily per-counterparty per-exposure-type
    use_cases:
      - counterparty risk monitoring
      - limit utilization analysis
      - CVA desk hedging
      - regulatory reporting (SA-CCR)
      - concentration risk assessment
    related_monikers: [credit.limits]
    columns:
      - name: ASOF_DATE
        type: date
        description: Business date of the exposure snapshot
        semantic_type: timestamp
        example: "2026-01-15"
      - name: COUNTERPARTY_ID
        type: string
        description: Unique counterparty identifier
        semantic_type: identifier
        example: CP001
      - name: COUNTERPARTY_NAME
        type: string
        description: Legal entity name
        semantic_type: dimension
        example: Goldman Sachs Group
      - name: SECTOR
        type: string
        description: Industry sector classification
        semantic_type: dimension
        example: Financials
      - name: RATING
        type: string
        description: Credit rating (S&P scale)
        semantic_type: dimension
        example: AA-
      - name: COUNTRY
        type: string
        description: Country of incorporation (ISO 3166-1 alpha-2)
        semantic_type: dimension
        example: US
      - name: EXPOSURE_TYPE
        type: string
        description: Type of credit exposure
        semantic_type: dimension
        example: Derivative
      - name: NOTIONAL
        type: float
        description: Notional amount of the exposure
        semantic_type: measure
        example: "150000000.00"
      - name: MARK_TO_MARKET
        type: float
        description: Current mark-to-market value
        semantic_type: measure
        example: "2350000.50"
      - name: PFE
        type: float
        description: Potential Future Exposure at 97.5% confidence
        semantic_type: measure
        example: "12500000.00"
      - name: CVA
        type: float
        description: Credit Valuation Adjustment
        semantic_type: measure
        example: "45000.00"
      - name: LGD
        type: float
        description: Loss Given Default (0-1)
        semantic_type: measure
        example: "0.45"
      - name: PD
        type: float
        description: Probability of Default (annualized)
        semantic_type: measure
        example: "0.002"
      - name: EXPECTED_LOSS
        type: float
        description: Expected loss = Notional x LGD x PD
        semantic_type: measure
        example: "135000.00"
      - name: CURRENCY
        type: string
        description: Exposure currency (ISO 4217)
        semantic_type: dimension
        example: USD
  data_quality:
    dq_owner: credit-dq@firm.com
    quality_score: 92
    known_issues:
      - "Weekend gaps in timeseries -- no weekend data points"
      - "Petrobras (CP006) rating may lag by 1 business day"
    validation_rules:
      - "NOTIONAL > 0"
      - "LGD BETWEEN 0 AND 1"
      - "PD BETWEEN 0 AND 1"
      - "EXPECTED_LOSS ≈ NOTIONAL × LGD × PD (±5%)"
    last_validated: "2026-01-28T06:30:00Z"
  tags: [credit, risk, mssql, counterparty, timeseries]

credit.limits:
  display_name: Credit Limits
  description: Counterparty credit limits with utilization, approval, and expiry information
  source_binding:
    type: mssql
    config:
      server: credit-risk-sql.firm.com
      port: 1433
      database: CreditRisk
      driver: "ODBC Driver 17 for SQL Server"
      query: >
        SELECT COUNTERPARTY_ID, LIMIT_TYPE, LIMIT_AMOUNT,
        UTILIZED, AVAILABLE, APPROVED_BY, EXPIRY_DATE
        FROM [dbo].[credit_limits]
  schema:
    description: Counterparty credit limits by type with utilization tracking
    semantic_tags: [credit, limits, counterparty, governance]
    primary_key: [COUNTERPARTY_ID, LIMIT_TYPE]
    use_cases:
      - limit utilization monitoring
      - limit breach alerts
      - counterparty onboarding
      - credit committee reporting
    related_monikers: [credit.exposures]
    granularity: per-counterparty per-limit-type
    columns:
      - name: COUNTERPARTY_ID
        type: string
        description: Unique counterparty identifier
        semantic_type: identifier
        example: CP001
      - name: LIMIT_TYPE
        type: string
        description: Type of credit limit
        semantic_type: dimension
        example: SingleName
      - name: LIMIT_AMOUNT
        type: float
        description: Approved credit limit
        semantic_type: measure
        example: "500000000.00"
      - name: UTILIZED
        type: float
        description: Amount currently utilized
        semantic_type: measure
        example: "350000000.00"
      - name: AVAILABLE
        type: float
        description: Remaining available limit
        semantic_type: measure
        example: "150000000.00"
      - name: APPROVED_BY
        type: string
        description: Approver name and title
        semantic_type: dimension
        example: "J. Smith (CRO)"
      - name: EXPIRY_DATE
        type: date
        description: Limit expiry date
        semantic_type: timestamp
        example: "2027-06-15"
  data_quality:
    dq_owner: credit-dq@firm.com
    quality_score: 98
    validation_rules:
      - "LIMIT_AMOUNT > 0"
      - "UTILIZED >= 0"
      - "AVAILABLE = LIMIT_AMOUNT - UTILIZED"
      - "EXPIRY_DATE > current_date"
    last_validated: "2026-01-28T06:30:00Z"
  tags: [credit, risk, mssql, limits, governance]

# ==========================================================================
# REPORTS/REGULATORY - Excel files (using slash path from demo catalog)
# ==========================================================================
reports/regulatory:
  display_name: Regulatory Reports
  classification: restricted
  source_binding:
    type: excel
    config:
      base_path: /data/reports/regulatory
      file_pattern: "{segments[0]}/{segments[1]}.xlsx"
      sheet: Summary
