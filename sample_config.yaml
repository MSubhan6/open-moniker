# Moniker Service Configuration

server:
  host: "0.0.0.0"
  port: 8050
  workers: 4
  reload: false

telemetry:
  enabled: true

  # Sink type: console | file | zmq
  sink_type: console

  # Sink-specific configuration
  sink_config:
    # For console sink:
    format: compact  # json | compact | pretty

    # For file sink (uncomment):
    # path_pattern: "telemetry-%Y%m%d.jsonl"
    # directory: "./logs/telemetry"
    # max_bytes: 104857600  # 100MB

    # For ZMQ sink (uncomment):
    # endpoint: "tcp://*:5555"
    # topic: "moniker.usage"

  # Batching configuration
  batch_size: 1000
  flush_interval_seconds: 1.0

  # Queue configuration
  max_queue_size: 10000

cache:
  enabled: true
  max_size: 10000
  default_ttl_seconds: 300  # 5 minutes

# Redis configuration for query result caching
# Used for expensive queries with cache config in source_binding
redis:
  enabled: false  # Enable to use Redis caching
  host: "localhost"
  port: 6379
  db: 0
  # password: ""  # Uncomment if Redis requires authentication
  prefix: "moniker:cache:"  # Key prefix for cached queries
  socket_timeout: 5.0
  socket_connect_timeout: 5.0

catalog:
  # Path to catalog definition file (copy sample_catalog.yaml to catalog.yaml)
  definition_file: "./catalog.yaml"

  # Hot reload interval (0 = disabled)
  reload_interval_seconds: 60

# Authentication configuration
auth:
  enabled: false
  enforce: false  # If false, allow anonymous fallback for dev/testing
  method_order: [kerberos, jwt]  # Try Kerberos first, then JWT

  # Kerberos SPNEGO configuration
  kerberos:
    enabled: false
    service_principal: "HTTP/moniker-svc.firm.com@FIRM.COM"
    keytab_path: "/etc/moniker-svc/krb5.keytab"
    realm: "FIRM.COM"

  # Okta JWT configuration
  okta:
    enabled: false
    issuer: "https://firm.okta.com/oauth2/default"
    audience: "api://moniker-svc"
    jwks_cache_ttl: 3600  # seconds
    user_claim: "sub"
    groups_claim: "groups"
    # Test mode (local dev only!): set issuer to "test" and provide secret
    # issuer: "test"
    # test_secret: "your-test-secret-min-32-chars-long"

# Config UI settings
config_ui:
  enabled: true
  yaml_output_path: "catalog_output.yaml"
  show_file_paths: false  # Show file paths in save success messages (useful for debugging)
